<div class="memes-management">
    <header class="page-header">
        <div class="header-content">
            <h1>Meme Templates</h1>
            <p class="subtitle">Manage your meme template library</p>
        </div>
        <button mat-raised-button color="primary" class="create-button" routerLink="/management/memes/create">
            <mat-icon>add</mat-icon>
            Create New Template
        </button>
    </header>

    <div class="controls">
        <mat-form-field class="search-field" appearance="outline">
            <mat-label>Search templates</mat-label>
            <input matInput [formControl]="searchControl" placeholder="Type to search..." type="text">
            <mat-icon matPrefix>search</mat-icon>
            @if (searchControl.value) {
            <button mat-icon-button matSuffix (click)="clearSearch()" aria-label="Clear search">
                <mat-icon>close</mat-icon>
            </button>
            }
        </mat-form-field>
    </div>

    @if (isLoading) {
    <div class="loading-container">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Loading templates...</p>
    </div>
    } @else if (paginatedTemplates.length === 0) {
    <div class="empty-state">
        <mat-icon class="empty-icon">image_not_supported</mat-icon>
        @if (searchControl.value) {
        <h2>No templates found</h2>
        <p>No templates match your search criteria. Try a different search term.</p>
        <button mat-raised-button (click)="clearSearch()">Clear Search</button>
        } @else {
        <h2>No templates yet</h2>
        <p>Get started by creating your first meme template.</p>
        <button mat-raised-button color="primary" routerLink="/management/memes/create">
            <mat-icon>add</mat-icon>
            Create Template
        </button>
        }
    </div>
    } @else {
    <div class="templates-grid">
        @for (template of paginatedTemplates; track template.id) {
        <mat-card class="template-card">
            <div class="card-image">
                <img [src]="template.imageUrl" [alt]="template.title" />
            </div>
            <mat-card-content>
                <h3 class="template-title">{{ template.title }}</h3>
                <div class="template-meta">
                    <div class="meta-item">
                        <mat-icon>text_fields</mat-icon>
                        <span>{{ getTextAreaCount(template) }} text areas</span>
                    </div>
                    <div class="meta-item">
                        <mat-icon>calendar_today</mat-icon>
                        <span>{{ formatDate(template.createdAt) }}</span>
                    </div>
                </div>
            </mat-card-content>
            <mat-card-actions>
                <button mat-button color="warn" (click)="deleteTemplate(template, $event)">
                    <mat-icon>delete</mat-icon>
                    Delete
                </button>
            </mat-card-actions>
        </mat-card>
        }
    </div>

    <mat-paginator [length]="totalItems" [pageSize]="pageSize" [pageIndex]="pageIndex"
        [pageSizeOptions]="[6, 12, 24, 48]" (page)="onPageChange($event)" showFirstLastButtons
        aria-label="Select page of meme templates">
    </mat-paginator>
    }
</div>